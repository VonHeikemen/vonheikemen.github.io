<!doctype html><html lang=en><head><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="text/html; charset=utf-8" http-equiv=content-type><meta content="width=device-width,initial-scale=1.0,maximum-scale=1,viewport-fit=cover" name=viewport><meta content="interest-cohort=()" http-equiv=Permissions-Policy><title>
  Navigate your command history with ease | Devlog
</title><link href=https://vonheikemen.github.io/devlog/print.css media=print rel=stylesheet><link href=https://vonheikemen.github.io/devlog/styles.css rel=stylesheet><link href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface" rel=stylesheet><link href=https://vonheikemen.github.io/devlog/atom.xml rel=alternate title=RSS type=application/atom+xml><link href=https://hachyderm.io/@vonheikemen rel=me><link href=https://twitter.com/VonHeikemen_ rel=me><meta content="shell, zsh, software, coding, development" name=keywords><meta content="Let's take advantage of all that data in our command history" name=description><body class=theme-base-custom><div class=sidebar><div class="container sidebar-sticky"><div class=sidebar-about><a href=https://vonheikemen.github.io/devlog/><h1>Devlog</h1></a></div><ul class=sidebar-nav><li class=sidebar-nav-item><a href=/>whoami</a><li class=sidebar-nav-item><a href=https://vonheikemen.github.io/devlog/tags/>Explore tags</a><li class=sidebar-nav-item><a href=https://vonheikemen.github.io/devlog/es/>Devlog en español</a><li class=sidebar-nav-item><a href=https://vonheikemen.github.io/devlog/atom.xml>RSS</a></ul> © 2020-2024 Heiker Curiel</div></div><div class="content container"><div class=post><h1 class=post-title>Navigate your command history with ease</h1><span class=post-date>2021-10-26 | 4 min read | <a href=https://vonheikemen.github.io/devlog/es/tools/navigate-command-history/> Leer en español </a> </span><p>When you spend too much time writting commands in the terminal it comes a time when you can't remember every program you have used during the day, not to mention previous days. Lucky for us we don't have to, the "shell" can do it for you. And today we are going to learn how can take advantage of this feature to improve the user experience in the terminal.<h2 id=commands-and-the-arrow-keys>Commands and the arrow keys</h2><p>I'm sure everyone here knows about the arrow keys, right? We can navigate the history up and down with them. Some of you might know about <code>ctrl+r</code>, which enables an interactive "reverse search" of old commands. But what if I told you we can get the best of two worlds?<p>We can write the first few letters of a command and press the up arrow key to start navigating throught the commands that begin with those letters.<p>Let's pretend we have these commands saved in our history.<pre style=background:#2b2c2f;color:#cccece><code><span>node ./test.js
</span><span>vi /tmp/text.txt
</span><span>nvim /tmp/text.txt
</span><span>vi /tmp/test.js
</span><span>echo "a string with vi in it"
</span><span>vi /tmp/other-text.txt
</span></code></pre><p>We want to look for the files we modified using <code>vi</code>. So we start by typing <code>vi</code> and right after we press the up key you'll notice your shell shows only these commands.<pre style=background:#2b2c2f;color:#cccece><code><span>vi /tmp/text.txt
</span><span>vi /tmp/test.js
</span><span>vi /tmp/other-text.txt
</span></code></pre><p>We can stop pressing the up key 20 times just because we don't want to write <code>npm start</code>. Type <code>np</code> + up arrow and we're there.<p>Sounds good, how can we enable this feature? Depends on your shell.<ul><li>In bash:</ul><pre class=language-sh data-lang=sh style=background:#2b2c2f;color:#cccece><code class=language-sh data-lang=sh><span style=color:#5f6364># Up arrow
</span><span style=color:#6699cc>bind </span><span style=color:#5fb3b3>'</span><span style=color:#99c794>"\e[A": history-search-backward</span><span style=color:#5fb3b3>'
</span><span>
</span><span style=color:#5f6364># Down arrow
</span><span style=color:#6699cc>bind </span><span style=color:#5fb3b3>'</span><span style=color:#99c794>"\e[B": history-search-forward</span><span style=color:#5fb3b3>'
</span></code></pre><ul><li>In zsh:</ul><pre class=language-sh data-lang=sh style=background:#2b2c2f;color:#cccece><code class=language-sh data-lang=sh><span style=color:#6699cc>autoload</span><span style=color:#5fb3b3> -</span><span style=color:#f99157>U</span><span style=color:#6699cc> up-line-or-beginning-search
</span><span style=color:#6699cc>autoload</span><span style=color:#5fb3b3> -</span><span style=color:#f99157>U</span><span style=color:#6699cc> down-line-or-beginning-search
</span><span>
</span><span style=color:#5f6364># Up arrow
</span><span style=color:#6699cc>bindkey </span><span style=color:#5fb3b3>"${</span><span>terminfo</span><span style=color:#5fb3b3>[</span><span>kcuu1</span><span style=color:#5fb3b3>]}"</span><span style=color:#6699cc> up-line-or-beginning-search
</span><span>
</span><span style=color:#5f6364># Down arrow
</span><span style=color:#6699cc>bindkey </span><span style=color:#5fb3b3>"${</span><span>terminfo</span><span style=color:#5fb3b3>[</span><span>kcud1</span><span style=color:#5fb3b3>]}"</span><span style=color:#6699cc> down-line-or-beginning-search
</span></code></pre><blockquote><p>Note: if you use <code>oh-my-zsh</code> it is already enabled for you.</blockquote><p>If for some reason <code>terminfo</code> is not defined try this in your terminal: press <code>ctrl+v</code> then one of the arrows, weird stuff will appear on the screen. In my case I get:<ul><li>Up: <code>^[OA</code><li>Down: <code>^[OB</code></ul><p>So use that instead of <code>terminfo</code>. This works on my machine.<pre class=language-sh data-lang=sh style=background:#2b2c2f;color:#cccece><code class=language-sh data-lang=sh><span style=color:#6699cc>bindkey </span><span style=color:#5fb3b3>'</span><span style=color:#99c794>^[OA</span><span style=color:#5fb3b3>'</span><span style=color:#6699cc> up-line-or-beginning-search
</span><span style=color:#6699cc>bindkey </span><span style=color:#5fb3b3>'</span><span style=color:#99c794>^[OB</span><span style=color:#5fb3b3>'</span><span style=color:#6699cc> down-line-or-beginning-search
</span></code></pre><h2 id=interactive-search>Interactive search</h2><p>If you didn't like the previous "trick" that's fine. Maybe you prefer the good old <code>ctrl+r</code>. Me? If I'm going to do an interactive search, I rather use <a href=https://github.com/junegunn/fzf rel=noopener target=_blank>fzf</a>. With <code>fzf</code> we get <a href=https://github.com/junegunn/fzf/tree/master/shell rel=noopener target=_blank>these scripts</a>, <code>key-bindings.*sh</code> in particular enables a history search with a better user experience than the old <code>ctrl+r</code>. Sadly there are too many ways to enable this (some depend on your OS) so if you want it, better go look for the method that's appropiate for your case.<h2 id=magic-space>Magic space</h2><p>Both <code>bash</code> and <code>zsh</code> have this thing called "history-expansion", it allow us to use pieces of data from the command history in our current command. For example:<ul><li><p><code>!!</code> is the last command in our history. So something like <code>sudo !!</code> is totally valid, in here we are saying "run the last command as sudo".</p><li><p><code>!$</code> is the last argument of the last command. If our last command was <code>nano /tmp/test.txt</code>, we could use <code>cat !$</code> to check the content of <code>/tmp/test.txt</code>.</p><li><p><code>!*</code> expands to all the arguments of the last command.</p></ul><p>There are more variants and combination but those are the ones I use frequently.<p>Anyway, if I'm using any of these symbols I'm going to "expand" them before running the command. I wouldn't run <code>sudo !!</code> without knowing for sure what is <code>!!</code>. To do this there is a command called <code>magic-space</code>. Just like our first "trick" we need to bind it to a key, which is usually space.<ul><li>bash</ul><pre class=language-sh data-lang=sh style=background:#2b2c2f;color:#cccece><code class=language-sh data-lang=sh><span style=color:#5f6364># Space, but magical
</span><span style=color:#6699cc>bind Space:magic-space
</span></code></pre><ul><li>zsh</ul><pre class=language-sh data-lang=sh style=background:#2b2c2f;color:#cccece><code class=language-sh data-lang=sh><span style=color:#5f6364># Space, but magical
</span><span style=color:#6699cc>bindkey </span><span style=color:#5fb3b3>' '</span><span style=color:#6699cc> magic-space
</span></code></pre><p>Now we could write <code>sudo !!</code> then press space and watch how <code>!!</code> transforms into the command we want to run.<h2 id=conclusion>Conclusion</h2><p>We learned a few tricks that can improve the user experience in our shell. We learned how to speed up our search with the arrow keys. Found out we can use <code>fzf</code> to search in the command history, basically like a better version of <code>ctrl+r</code>. And finally, we got a tiny glimpse of this thing called history-expansion, we can use to query the history and use some pieces in our commands.<hr><p>Have any question? Feel free to leave a comment in one of these platform where I have shared this:<ul><li><a href=https://dev.to/vonheikemen/navigate-your-command-history-with-ease-1f5b rel=noopener target=_blank>dev.to</a><li><a href=https://vonheikemen.hashnode.dev/navigate-your-command-history-with-ease rel=noopener target=_blank>Hashnode</a></ul><p>You can reach out to me on social media:<ul><li>Twitter <a rel="noopener me" href=https://twitter.com/VonHeikemen_ target=_blank> @VonHeikemen_ </a><li>Mastodon <a rel="noopener me" href=https://hachyderm.io/@vonheikemen target=_blank> @vonheikemen@hachyderm.io </a></ul><p>Thank you for reading. If you find this article useful and want to support my efforts, buy me a coffee ☕</p><a href=https://ko-fi.com/vonheikemen style=display:flex;justify-content:center target=_blank> <img alt="Buy Me A Coffee" src="https://storage.ko-fi.com/cdn/kofi2.png?v=3" style=height:60px!important;width:217px!important> </a></div></div>