<!doctype html><html lang=es><head><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="text/html; charset=utf-8" http-equiv=content-type><meta content="width=device-width,initial-scale=1.0,maximum-scale=1,viewport-fit=cover" name=viewport><meta content="interest-cohort=()" http-equiv=Permissions-Policy><title>
  Navega a través del historial de comandos de una manera eficiente | Devlog
</title><link href=https://vonheikemen.github.io/devlog/print.css media=print rel=stylesheet><link href=https://vonheikemen.github.io/devlog/styles.css rel=stylesheet><link href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface" rel=stylesheet><link href=https://hachyderm.io/@vonheikemen rel=me><link href=https://twitter.com/VonHeikemen_ rel=me><meta content="shell, zsh, software, coding, development" name=keywords><meta content="Vamos a sacarle provecho a toda esa información en el historial" name=description><body class=theme-base-custom><div class=sidebar><div class="container sidebar-sticky"><div class=sidebar-about><a href=https://vonheikemen.github.io/devlog/es/><h1>Devlog</h1></a></div><ul class=sidebar-nav><li class=sidebar-nav-item><a href=/>whoami</a><li class=sidebar-nav-item><a href=https://vonheikemen.github.io/devlog/es/tags/>Explorar tags</a><li class=sidebar-nav-item><a href=https://vonheikemen.github.io/devlog/>Devlog in english</a></ul> © 2020-2024 Heiker Curiel</div></div><div class="content container"><div class=post><h1 class=post-title>Navega a través del historial de comandos de una manera eficiente</h1><span class=post-date>2021-10-25 | 4 minutos | <a href=https://vonheikemen.github.io/devlog/tools/navigate-command-history/> Read in english </a> </span><p>Si pasan mucho tiempo en la terminal va a llegar un momento en el que no podrán recordar todos los comandos que usaron durante el día, y ni hablar de los días anteriores. Por suerte para nosotros nuestro "shell" puede almacenar esta información por nosotros. Ahora les voy a enseñar cómo podemos sacar provecho de esta información para mejorar nuestra experiencia en la terminal.<h2 id=comandos-viejos-y-las-flechas>Comandos viejos y las flechas</h2><p>Estoy seguro que todos aquí saben que pueden navegar el historial de comandos usando las flechas. Algunos de ustedes saben que pueden usar <code>ctrl+r</code> para activar una especie de buscador para revisar comandos viejos. ¿Pero y si les digo que podemos obtener lo mejor de estos dos métodos?<p>Podemos escribir las primeras letras de un comando y presionar la flecha hacia arriba para empezar a buscar los comandos que comienzen con ese "prefijo".<p>Imaginen. Tienen los siguientes comandos en su historial.<pre style=background:#2b2c2f;color:#cccece><code><span>node ./test.js
</span><span>vi /tmp/text.txt
</span><span>nvim /tmp/text.txt
</span><span>vi /tmp/test.js
</span><span>echo "a string with vi in it"
</span><span>vi /tmp/other-text.txt
</span></code></pre><p>Quieren buscar los archivos que han editado con <code>vi</code>, escriben <code>vi</code> e inmediatamente presionan la flecha hacia arriba. En este caso en pantalla se muestran sólo los comandos que comienzan con <code>vi</code>:<pre style=background:#2b2c2f;color:#cccece><code><span>vi /tmp/text.txt
</span><span>vi /tmp/test.js
</span><span>vi /tmp/other-text.txt
</span></code></pre><p>Sería genial. Basta de presionar 20 veces la flecha hacia arriba para evitar escribir <code>npm start</code>. Sólo usen <code>np</code> + flecha hacia arriba.<p>¿Cómo podemos habilitar esta maravilla?<ul><li>En bash:</ul><pre class=language-sh data-lang=sh style=background:#2b2c2f;color:#cccece><code class=language-sh data-lang=sh><span style=color:#5f6364># Flecha hacia arriba
</span><span style=color:#6699cc>bind </span><span style=color:#5fb3b3>'</span><span style=color:#99c794>"\e[A": history-search-backward</span><span style=color:#5fb3b3>'
</span><span>
</span><span style=color:#5f6364># Flecha hacia abajo
</span><span style=color:#6699cc>bind </span><span style=color:#5fb3b3>'</span><span style=color:#99c794>"\e[B": history-search-forward</span><span style=color:#5fb3b3>'
</span></code></pre><ul><li>En zsh:</ul><pre class=language-sh data-lang=sh style=background:#2b2c2f;color:#cccece><code class=language-sh data-lang=sh><span style=color:#6699cc>autoload</span><span style=color:#5fb3b3> -</span><span style=color:#f99157>U</span><span style=color:#6699cc> up-line-or-beginning-search
</span><span style=color:#6699cc>autoload</span><span style=color:#5fb3b3> -</span><span style=color:#f99157>U</span><span style=color:#6699cc> down-line-or-beginning-search
</span><span>
</span><span style=color:#5f6364># Flecha hacia arriba
</span><span style=color:#6699cc>bindkey </span><span style=color:#5fb3b3>"${</span><span>terminfo</span><span style=color:#5fb3b3>[</span><span>kcuu1</span><span style=color:#5fb3b3>]}"</span><span style=color:#6699cc> up-line-or-beginning-search
</span><span>
</span><span style=color:#5f6364># Flecha hacia abajo
</span><span style=color:#6699cc>bindkey </span><span style=color:#5fb3b3>"${</span><span>terminfo</span><span style=color:#5fb3b3>[</span><span>kcud1</span><span style=color:#5fb3b3>]}"</span><span style=color:#6699cc> down-line-or-beginning-search
</span></code></pre><blockquote><p>Nota: Si usan <code>oh-my-zsh</code> esta funcionalidad ya está activada.</blockquote><p>Si por alguna razón <code>terminfo</code> no está definido intenten esto en la terminal: presionan <code>ctrl+v</code> luego una de las flechas. En mi caso obtengo:<ul><li>Arriba: <code>^[OA</code><li>Abajo: <code>^[OB</code></ul><p>Entonces para mí esto también funciona.<pre class=language-sh data-lang=sh style=background:#2b2c2f;color:#cccece><code class=language-sh data-lang=sh><span style=color:#6699cc>bindkey </span><span style=color:#5fb3b3>'</span><span style=color:#99c794>^[OA</span><span style=color:#5fb3b3>'</span><span style=color:#6699cc> up-line-or-beginning-search
</span><span style=color:#6699cc>bindkey </span><span style=color:#5fb3b3>'</span><span style=color:#99c794>^[OB</span><span style=color:#5fb3b3>'</span><span style=color:#6699cc> down-line-or-beginning-search
</span></code></pre><h2 id=busqueda-interactiva>Búsqueda interactiva</h2><p>Si el "truco" anterior no los impresiona está bien. Todos tenemos nuestras preferencias. Para realizar una búsqueda interactiva prefiero usar <a href=https://github.com/junegunn/fzf rel=noopener target=_blank>fzf</a>. <code>fzf</code> tiene <a href=https://github.com/junegunn/fzf/tree/master/shell rel=noopener target=_blank>unos scripts</a> (key-bindings.*sh) que nos brinda un buscador con una mejor experiencia de usuario que el tradicional <code>ctrl+r</code>. Para habilitarlo hay muchas formas (depende de su sistema operativo), así que será mejor que investiguen por su cuenta cómo hacerlo.<h2 id=espacio-magico>Espacio mágico</h2><p>En <code>bash</code> y <code>zsh</code> hay algo llamado "history-expansion". Basícamente es una forma de consultar la data que tenemos en nuestro historial y usarlo en un comando.<p>Por ejemplo, tenemos que:<ul><li><p><code>!!</code> se usa para indicar que queremos usar el último comando en nuestro historial. Entonces algo como esto es válido <code>sudo !!</code>, aquí estamos diciendo "ejecuta el último comando con <code>sudo</code>".</p><li><p><code>!$</code> es el último argumento del último comando del historial. Si el último comando que usamos fue <code>nano /tmp/test.txt</code> y luego usamos <code>cat !$</code>, <code>cat</code> va a mostrar <code>/tmp/test.txt</code>.</p><li><p><code>!*</code> todos los argumentos del último comando del historial.</p></ul><p>Hay más variantes y combinaciones pero esos son los que uso con más frecuencia.<p>En fin, yo prefiero "expandir" estos símbolos antes de ejecutar el comando. No me gustaría ejecutar un comando como <code>sudo !!</code> sin saber qué es <code>!!</code>. Para esto uso comando que se llama <code>magic-space</code>. Al igual que en nuestro primer "truco" este es un comando que debemos vincular a una tecla, por lo general a la tecla de espacio.<ul><li>bash</ul><pre class=language-sh data-lang=sh style=background:#2b2c2f;color:#cccece><code class=language-sh data-lang=sh><span style=color:#5f6364># Espacio, pero mágico
</span><span style=color:#6699cc>bind Space:magic-space
</span></code></pre><ul><li>zsh</ul><pre class=language-sh data-lang=sh style=background:#2b2c2f;color:#cccece><code class=language-sh data-lang=sh><span style=color:#5f6364># Espacio, pero mágico
</span><span style=color:#6699cc>bindkey </span><span style=color:#5fb3b3>' '</span><span style=color:#6699cc> magic-space
</span></code></pre><p>Luego de esto podremos expandir todos estos símbolos antes de ejecutar el comando. Podríamos escribir <code>sudo !!</code> y luego si presionamos espacio veremos cómo <code>!!</code> se transforma en el comando que vamos a ejecutar.<h2 id=conclusion>Conclusión</h2><p>Descubrimos varias maneras mejorar la experiencia de usuario de nuestro "shell" con una serie de trucos. Aprendimos cómo optimizar la búsqueda de comandos con las flechas. Descubrimos <code>fzf</code> como una alternativa al <code>ctrl+r</code>. Aprendimos sobre la "expansión de historial" (history-expansion) para consultar el historial y usar el resultado en el comando que estamos creando. Utilizar estos pequeños trucos en su rutina verán que con el tiempo la experiencia usando la terminal se vuelve un poco más placentera.<hr><p>¿Tienen alguna pregunta? Pueden dejar un comentario en cualquiera de estas plataformas:<ul><li><a href=https://dev.to/vonheikemen/navega-a-traves-del-historial-de-comandos-de-una-manera-eficiente-191d rel=noopener target=_blank>dev.to</a><li><a href=https://vonheikemen.hashnode.dev/navigate-your-command-history-with-ease-es rel=noopener target=_blank>Hashnode</a></ul><p>Pueden contactarme por las redes sociales:<ul><li>Twitter <a rel="noopener me" href=https://twitter.com/VonHeikemen_ target=_blank> @VonHeikemen_ </a><li>Mastodon <a rel="noopener me" href=https://hachyderm.io/@vonheikemen target=_blank> @vonheikemen@hachyderm.io </a></ul><p>Gracias por su tiempo. Si este artículo les pareció útil y quieren apoyar mis esfuerzos para crear más contenido, pueden dejar una propina en buy me a coffee ☕.</p><a href=https://www.buymeacoffee.com/vonheikemen style=display:flex;justify-content:center target=_blank> <img alt="Buy Me A Coffee" src=https://cdn.buymeacoffee.com/buttons/v2/default-blue.png style=height:60px!important;width:217px!important> </a></div></div>