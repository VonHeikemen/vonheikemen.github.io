<!doctype html><html lang=es><head><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="text/html; charset=utf-8" http-equiv=content-type><meta content="width=device-width,initial-scale=1.0,maximum-scale=1,viewport-fit=cover" name=viewport><meta content="interest-cohort=()" http-equiv=Permissions-Policy><title>
  Cómo crear tu primera configuración de Neovim usando lua | Devlog
</title><link href=https://vonheikemen.github.io/devlog/print.css media=print rel=stylesheet><link href=https://vonheikemen.github.io/devlog/styles.css rel=stylesheet><link href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface" rel=stylesheet><link href=https://hachyderm.io/@vonheikemen rel=me><link href=https://twitter.com/VonHeikemen_ rel=me><meta content="vim, neovim, shell, software, coding, development" name=keywords><meta content="Donde aprendemos cómo personalizar Neovim y agregar plugins" name=description><body class=theme-base-custom><div class=sidebar><div class="container sidebar-sticky"><div class=sidebar-about><a href=https://vonheikemen.github.io/devlog/es/><h1>Devlog</h1></a></div><ul class=sidebar-nav><li class=sidebar-nav-item><a href=/>whoami</a><li class=sidebar-nav-item><a href=https://vonheikemen.github.io/devlog/es/tags/>Explorar tags</a><li class=sidebar-nav-item><a href=https://vonheikemen.github.io/devlog/>Devlog in english</a></ul> © 2020-2023 Heiker Curiel</div></div><div class="content container"><div class=post><h1 class=post-title>Cómo crear tu primera configuración de Neovim usando lua</h1><span class=post-date>2022-07-02 | 20 minutos | <a href=https://vonheikemen.github.io/devlog/tools/build-your-first-lua-config-for-neovim/> Read in english </a> </span><blockquote>Última actualización: 2023-09-26</blockquote><p>Neovim es un editor que se caracteriza por ser extensible, con suficiente esfuerzo podemos convertirlo en algo más que un editor de texto. Hoy espero poder enseñarles suficiente sobre <code>lua</code> y la api de Neovim para poder construir una configuración que se adapte a sus necesidades.<p>Lo que haremos será crear un archivo de configuración que llamaremos <code>init.lua</code>, agregaremos un par de plugins y les diré cómo crear sus propios comandos.<p>Este tutorial está pensado para aquellos que son totalmente nuevos en Neovim. Si ustedes ya tienen una configuración escrita en vimscript y desean migrarla a lua, encontrarán todo lo que necesitan aquí: <a href=https://vonheikemen.github.io/devlog/es/tools/configuring-neovim-using-lua/>Todo lo que necesitan saber para configurar neovim usando lua</a>.<h2 id=recomendaciones>Recomendaciones</h2><p>Antes de empezar, les aconsejo que instalen la versión de Neovim estable más reciente. Pueden visitar la <a href=https://github.com/neovim/neovim/releases rel=noopener target=_blank>sección releases</a> del repositorio en github y descargarla de ahí. De aquí en adelante voy a asumir que están usando la version 0.8 o mayor.<p>Si aún no se sienten cómodos usando Neovim para editar texto, hagan el tutorial interactivo que viene incluido. Pueden acceder a él ejecutando este comando en su terminal.<pre class=language-sh data-lang=sh style=background:#2b2c2f;color:#cccece><code class=language-sh data-lang=sh><span style=color:#6699cc>nvim +Tutor
</span></code></pre><p>El tutorial está inglés. Si no tienen un buen dominio del idioma pueden <a href=https://raw.githubusercontent.com/vim/vim/d899e51120798d3fb5420abb1f19dddf3f014d05/runtime/tutor/tutor.es rel=noopener target=_blank>descargar la versión en español</a>. Guardan ese archivo en algún lugar de su sistema y lo abren con Neovim. Voy a asumir que ya conocen todas las funcionalidades que enseña el tutor.<h2 id=el-inicio>El Inicio</h2><p>Lo primero que debemos hacer es crear nuestro archivo de configuración, el famoso <code>init.lua</code>. ¿Dónde? Depende de su sistema operativo, y también de sus variables de entorno. Pero puedo enseñarles cómo crearlo desde Neovim, así no tenemos que preocuparnos por esos detalles.<blockquote><p>Dato curioso: En algunos tutoriales se refieren al archivo de configuración como <code>vimrc</code>, porque ese es el nombre que tiene el archivo en Vim.</blockquote><p>En esta sección no vamos a usar lua, usaremos el lenguaje que fue creado para Vim: vimscript.<p>Vamos a abrir Neovim y luego ejecutamos este comando.<pre class=language-vim data-lang=vim style=background:#2b2c2f;color:#cccece><code class=language-vim data-lang=vim><span>:call </span><span style=color:#6699cc>mkdir</span><span>(</span><span style=color:#6699cc>stdpath</span><span>(</span><span style=color:#99c794>"config"</span><span>), </span><span style=color:#99c794>"p"</span><span>)
</span></code></pre><p>Con esto crearemos la carpeta donde vivirá nuestra configuración. Si quieren saber qué carpeta fue creada ejecuten esto.<pre class=language-vim data-lang=vim style=background:#2b2c2f;color:#cccece><code class=language-vim data-lang=vim><span>:</span><span style=color:#6699cc>echo stdpath</span><span>(</span><span style=color:#99c794>"config"</span><span>)
</span></code></pre><p>Ahora vamos con el comando para editar la configuración.<pre class=language-vim data-lang=vim style=background:#2b2c2f;color:#cccece><code class=language-vim data-lang=vim><span>:</span><span style=color:#6699cc>exe </span><span style=color:#99c794>"edit" </span><span style=color:#6699cc>stdpath</span><span>(</span><span style=color:#99c794>"config"</span><span>) . </span><span style=color:#99c794>"/init.lua"
</span></code></pre><p>Después de ejecutarlo tendremos una página en blanco, pero el archivo aún no existe en el sistema. Para crearlo debemos guardarlo. Ejecuten esto.<pre class=language-vim data-lang=vim style=background:#2b2c2f;color:#cccece><code class=language-vim data-lang=vim><span>:write
</span></code></pre><p>Una vez que tenemos el archivo podremos editarlo en cualquier momento con este comando.<pre class=language-vim data-lang=vim style=background:#2b2c2f;color:#cccece><code class=language-vim data-lang=vim><span>:edit $MYVIMRC
</span></code></pre><p>Si ustedes son de aquellas personas que les gusta crear scripts para automatizar sus tareas, pueden ejecutar todos estos pasos con un sólo comando.<pre class=language-sh data-lang=sh style=background:#2b2c2f;color:#cccece><code class=language-sh data-lang=sh><span style=color:#6699cc>nvim</span><span style=color:#5fb3b3> --</span><span style=color:#f99157>headless</span><span style=color:#5fb3b3> -</span><span style=color:#f99157>c </span><span style=color:#5fb3b3>'</span><span style=color:#99c794>call mkdir(stdpath("config"), "p") | exe "edit" stdpath("config") . "/init.lua" | write | quit</span><span style=color:#5fb3b3>'
</span></code></pre><h2 id=opciones-del-editor>Opciones del editor</h2><p>Para acceder a las opciones de Neovim debemos usar la variable global <code>vim</code>. Bueno, más que una variable, es un módulo donde podemos encontrar cualquier tipo de utilidades. Pero ahora lo que nos interesa es una propiedad llamada <code>opt</code>, con eso podremos modificar cualquiera de las 351 opciones que ofrece Neovim (en su versión 0.7).<p>Esta es la sintaxis que deben seguir.<pre class=language-lua data-lang=lua style=background:#2b2c2f;color:#cccece><code class=language-lua data-lang=lua><span>vim</span><span style=color:#5fb3b3>.</span><span>opt</span><span style=color:#5fb3b3>.</span><span>nombre_opcion </span><span style=color:#5fb3b3>= </span><span>valor
</span></code></pre><p>Donde <code>nombre_opcion</code> puede ser cualquiera de <a href=https://neovim.io/doc/user/quickref.html#option-list rel=noopener target=_blank>esta lista</a>. Y <code>valor</code> debe concordar con el tipo de dato que espera la opción.<blockquote><p>Pueden ver la lista de opciones desde Neovim con el comando <code>:help option-list</code>.</blockquote><p>Deben tener en cuenta que cada opción tiene un "ámbito". Algunas opciones son globales, otras se limitan a la ventana o archivo que están manipulando en su momento. Para conocer estos detalles revisen la documentación de esta manera.<pre class=language-vim data-lang=vim style=background:#2b2c2f;color:#cccece><code class=language-vim data-lang=vim><span>:help </span><span style=color:#99c794>'nombre_opcion'
</span></code></pre><h3 id=opciones-de-interes>Opciones de interés</h3><ul><li><code>number</code></ul><p>Esta opción es de tipo booleano, quiere decir que sólo tiene dos posibles valores: <code>true</code> o <code>false</code>. Si le asignamos el valor <code>true</code> la habilitamos, <code>false</code> hace lo contrario.<p>Al habilitar <code>number</code> Neovim nos muestra los números de cada línea en pantalla.<pre class=language-lua data-lang=lua style=background:#2b2c2f;color:#cccece><code class=language-lua data-lang=lua><span>vim</span><span style=color:#5fb3b3>.</span><span>opt</span><span style=color:#5fb3b3>.</span><span>number </span><span style=color:#5fb3b3>= </span><span style=color:#f99157>true
</span></code></pre><ul><li><code>mouse</code></ul><p>Neovim (y Vim) puede utilizar el ratón para algunas operaciones, cosas como seleccionar texto o cambiar el tamaño de una ventana. <code>mouse</code> acepta una cadena de texto (carácteres rodeados por comillas) que contiene una combinación de modos. No vamos a preocuparnos por los modos, podemos habilitarlo para todos así:<pre class=language-lua data-lang=lua style=background:#2b2c2f;color:#cccece><code class=language-lua data-lang=lua><span>vim</span><span style=color:#5fb3b3>.</span><span>opt</span><span style=color:#5fb3b3>.</span><span>mouse </span><span style=color:#5fb3b3>= '</span><span style=color:#99c794>a</span><span style=color:#5fb3b3>'
</span></code></pre><ul><li><code>ignorecase</code></ul><p>Con esto le decimos a Neovim si debe ignorar las letrás mayúsculas cuando realizamos una búsqueda. Por ejemplo, si buscamos la palabra <code>dos</code> nuestros resultados pueden incluir diferentes variaciones como <code>Dos</code>, <code>DOS</code> o <code>dos</code>.<pre class=language-lua data-lang=lua style=background:#2b2c2f;color:#cccece><code class=language-lua data-lang=lua><span>vim</span><span style=color:#5fb3b3>.</span><span>opt</span><span style=color:#5fb3b3>.</span><span>ignorecase </span><span style=color:#5fb3b3>= </span><span style=color:#f99157>true
</span></code></pre><ul><li><code>smartcase</code></ul><p>Hace que nuestra búsqueda ignore las letrás mayúsculas a menos que el término que estamos buscando tenga una letra mayúscula. Generalmente se usa en conjunto con <code>ignorecase</code>.<pre class=language-lua data-lang=lua style=background:#2b2c2f;color:#cccece><code class=language-lua data-lang=lua><span>vim</span><span style=color:#5fb3b3>.</span><span>opt</span><span style=color:#5fb3b3>.</span><span>smartcase </span><span style=color:#5fb3b3>= </span><span style=color:#f99157>true
</span></code></pre><ul><li><code>hlsearch</code></ul><p>Resalta los resultados de una búsqueda anterior. La mayor parte del tiempo no queremos esto, así que lo deshabilitamos.<pre class=language-lua data-lang=lua style=background:#2b2c2f;color:#cccece><code class=language-lua data-lang=lua><span>vim</span><span style=color:#5fb3b3>.</span><span>opt</span><span style=color:#5fb3b3>.</span><span>hlsearch </span><span style=color:#5fb3b3>= </span><span style=color:#f99157>false
</span></code></pre><ul><li><code>wrap</code></ul><p>Hace que el texto de las líneas largas (las que sobrepasan el ancho de la pantalla) siempre esté visible. Su valor defecto es <code>true</code>.<pre class=language-lua data-lang=lua style=background:#2b2c2f;color:#cccece><code class=language-lua data-lang=lua><span>vim</span><span style=color:#5fb3b3>.</span><span>opt</span><span style=color:#5fb3b3>.</span><span>wrap </span><span style=color:#5fb3b3>= </span><span style=color:#f99157>true
</span></code></pre><ul><li><code>breakindent</code></ul><p>Conserva la indentación de las líneas que sólo son visibles cuando <code>wrap</code> es <code>true</code>.<pre class=language-lua data-lang=lua style=background:#2b2c2f;color:#cccece><code class=language-lua data-lang=lua><span>vim</span><span style=color:#5fb3b3>.</span><span>opt</span><span style=color:#5fb3b3>.</span><span>breakindent </span><span style=color:#5fb3b3>= </span><span style=color:#f99157>true
</span></code></pre><ul><li><code>tabstop</code></ul><p>La cantidad de carácteres que ocupa <code>Tab</code>. El valor por defecto es 8. Yo prefiero 2.<pre class=language-lua data-lang=lua style=background:#2b2c2f;color:#cccece><code class=language-lua data-lang=lua><span>vim</span><span style=color:#5fb3b3>.</span><span>opt</span><span style=color:#5fb3b3>.</span><span>tabstop </span><span style=color:#5fb3b3>= </span><span style=color:#f99157>2
</span></code></pre><ul><li><code>shiftwidth</code></ul><p>El espacio que Neovim usará para indentar una línea. Esta opción afecta los atajos <code><<</code> y <code>>></code>. Su valor por defecto es 8. La convención es tener el mismo valor que <code>tabstop</code>.<pre class=language-lua data-lang=lua style=background:#2b2c2f;color:#cccece><code class=language-lua data-lang=lua><span>vim</span><span style=color:#5fb3b3>.</span><span>opt</span><span style=color:#5fb3b3>.</span><span>shiftwidth </span><span style=color:#5fb3b3>= </span><span style=color:#f99157>2
</span></code></pre><ul><li><code>expandtab</code></ul><p>Determina si Neovim debe transformar el carácter <code>Tab</code> en espacios. Su valor por defecto es <code>false</code>.<pre class=language-lua data-lang=lua style=background:#2b2c2f;color:#cccece><code class=language-lua data-lang=lua><span>vim</span><span style=color:#5fb3b3>.</span><span>opt</span><span style=color:#5fb3b3>.</span><span>expandtab </span><span style=color:#5fb3b3>= </span><span style=color:#f99157>false
</span></code></pre><p>En lo que se refiere a configuración de variables hay más características que podría mencionar, pero tenemos otras cosas qué hacer. Pueden encontrar más detalles del tema aquí: <a href=https://vonheikemen.github.io/devlog/es/tools/configuring-neovim-using-lua/#opciones-del-editor>Configurando neovim - Opciones del editor</a>.<h2 id=atajos-de-teclado>Atajos de teclado</h2><p>Neovim no tiene suficientes, tenemos que crear más. Para esto debemos aprender a usar la función <code>vim.keymap.set</code>. Les mostraré un ejemplo.<pre class=language-lua data-lang=lua style=background:#2b2c2f;color:#cccece><code class=language-lua data-lang=lua><span>vim</span><span style=color:#5fb3b3>.</span><span>keymap</span><span style=color:#5fb3b3>.</span><span style=color:#6699cc>set</span><span style=color:#5fb3b3>('</span><span style=color:#99c794>n</span><span style=color:#5fb3b3>', '</span><span style=color:#99c794>&LTspace>w</span><span style=color:#5fb3b3>', '</span><span style=color:#99c794>&LTcmd>write&LTcr></span><span style=color:#5fb3b3>', {</span><span style=color:#99c794>desc </span><span style=color:#5fb3b3>= '</span><span style=color:#99c794>Guardar</span><span style=color:#5fb3b3>'})
</span></code></pre><p>Después de ejecutar esta función la combinación <code>Espacio</code> + <code>w</code> nos permitirá usar el comando <code>write</code>. Podremos guardar el archivo actual con <code>Espacio</code> + <code>w</code>.<p>Ahora déjenme explicarles qué hace cada parámetro.<pre class=language-lua data-lang=lua style=background:#2b2c2f;color:#cccece><code class=language-lua data-lang=lua><span>vim</span><span style=color:#5fb3b3>.</span><span>keymap</span><span style=color:#5fb3b3>.</span><span style=color:#6699cc>set</span><span style=color:#5fb3b3>({</span><span>mode</span><span style=color:#5fb3b3>}, {</span><span>lhs</span><span style=color:#5fb3b3>}, {</span><span>rhs</span><span style=color:#5fb3b3>}, {</span><span>opts</span><span style=color:#5fb3b3>})
</span></code></pre><ul><li><p><code>{mode}</code> es el modo donde tendrá efecto nuestro atajo (puede ser una lista de modos). Pero no necesitamos nombres, necesitamos la abreviación. Estas son las más comunes.</p> <ul><li><code>n</code>: Modo normal.<li><code>i</code>: Modo de inserción.<li><code>x</code>: Modo visual.<li><code>s</code>: Modo de selección.<li><code>v</code>: Visual y selección.<li><code>t</code>: Modo de terminal.<li><code>o</code>: Modo de espera de operador.<li><code>''</code>: Sí, una cadena de texto vacía. Es el equivalente a <code>n</code> + <code>v</code> + <code>o</code>.</ul><li><p><code>{lhs}</code> es el atajo que queremos crear.</p><li><p><code>{rhs}</code> es la acción que queremos ejecutar. Puede ser un comando, una expresión o una función de lua.</p><li><p><code>{opts}</code> este parámetro debe ser una tabla de lua. Si no saben qué es una tabla, sólo piensen que es una manera albergar varios tipos de datos en un lugar. En fin, estas son las propiedades de uso común.</p> <ul><li><p><code>desc</code>: Cadena de texto que describe qué hace el comando. Aquí podemos escribir cualquier cosa.</p><li><p><code>remap</code>: Booleano que controla si nuestro atajo debe ser recursivo. Su valor por defecto es <code>false</code>. Los atajos recursivos pueden crear conflictos, así que no lo habiliten si no saben todos los detalles de lo que quieren lograr. Luego les explico con más detalle.</p><li><p><code>buffer</code>: Puede ser un Booleano o un número. Si el valor es el booleano <code>true</code> quiere decir que al atajo sólo tendrá efecto en el archivo actual. Si es un número deberá ser el "id" de un archivo que tenemos abierto.</p><li><p><code>silent</code>: Booleano que controla si el atajo puede mostrar un mensaje. Su valor por defecto es <code>false</code>.</p><li><p><code>expr</code>: Booleano. Si lo habilitamos tendremos la posibilidad de usar vimscript o lua para generar el valor del parámetro <code>{rhs}</code>. Su valor por defecto es <code>false</code>.</p></ul></ul><h3 id=la-tecla-lider>La tecla líder</h3><p>Cuando definimos nuestros atajos podemos usar la secuencia especial <code>&LTleader></code> en el parámetro <code>{lhs}</code>, esta toma el valor que tenemos en la variable global <code>mapleader</code>.<p><code>mapleader</code> es una variable que debe ser una cadena texto. Por ejemplo.<pre class=language-lua data-lang=lua style=background:#2b2c2f;color:#cccece><code class=language-lua data-lang=lua><span>vim</span><span style=color:#5fb3b3>.</span><span>g</span><span style=color:#5fb3b3>.</span><span>mapleader </span><span style=color:#5fb3b3>= '</span><span style=color:#99c794>,</span><span style=color:#5fb3b3>'
</span></code></pre><p>Con esto podríamos usar la tecla <code>,</code> como un prefijo para nuestros atajos.<pre class=language-lua data-lang=lua style=background:#2b2c2f;color:#cccece><code class=language-lua data-lang=lua><span>vim</span><span style=color:#5fb3b3>.</span><span>keymap</span><span style=color:#5fb3b3>.</span><span style=color:#6699cc>set</span><span style=color:#5fb3b3>('</span><span style=color:#99c794>n</span><span style=color:#5fb3b3>', '</span><span style=color:#99c794>&LTleader>w</span><span style=color:#5fb3b3>', '</span><span style=color:#99c794>&LTcmd>write&LTcr></span><span style=color:#5fb3b3>')
</span></code></pre><p>Y así la secuencia <code>,</code> + <code>w</code> guarda el archivo actual.<p>¿Qué pasa si no definimos <code>mapleader</code>? Por defecto tiene el valor <code>\</code>, que no es lo mejor del mundo. Mi recomendación para la tecla líder es usar <code>Espacio</code>. Pueden hacer esto.<pre class=language-lua data-lang=lua style=background:#2b2c2f;color:#cccece><code class=language-lua data-lang=lua><span>vim</span><span style=color:#5fb3b3>.</span><span>g</span><span style=color:#5fb3b3>.</span><span>mapleader </span><span style=color:#5fb3b3>= ' '
</span></code></pre><h3 id=atajos>Atajos</h3><p>Ahora les mostraré algunos atajos que pueden ser útiles para ustedes.<ul><li>Copiar y pegar del portapapeles</ul><p>Por defecto Neovim (y Vim) no interactúa con el portapapeles. Cuando copiamos algún texto con la tecla <code>y</code> el contenido se va un registro interno. Yo prefiero conservar esta funcionalidad y crear atajos dedicados para manipular el portapapeles.<p>Copia al portapapeles.<pre class=language-lua data-lang=lua style=background:#2b2c2f;color:#cccece><code class=language-lua data-lang=lua><span>vim</span><span style=color:#5fb3b3>.</span><span>keymap</span><span style=color:#5fb3b3>.</span><span style=color:#6699cc>set</span><span style=color:#5fb3b3>({'</span><span style=color:#99c794>n</span><span style=color:#5fb3b3>', '</span><span style=color:#99c794>x</span><span style=color:#5fb3b3>'}, '</span><span style=color:#99c794>cp</span><span style=color:#5fb3b3>', '</span><span style=color:#99c794>"+y</span><span style=color:#5fb3b3>')
</span></code></pre><p>Pegar desde el portapapeles.<pre class=language-lua data-lang=lua style=background:#2b2c2f;color:#cccece><code class=language-lua data-lang=lua><span>vim</span><span style=color:#5fb3b3>.</span><span>keymap</span><span style=color:#5fb3b3>.</span><span style=color:#6699cc>set</span><span style=color:#5fb3b3>({'</span><span style=color:#99c794>n</span><span style=color:#5fb3b3>', '</span><span style=color:#99c794>x</span><span style=color:#5fb3b3>'}, '</span><span style=color:#99c794>cv</span><span style=color:#5fb3b3>', '</span><span style=color:#99c794>"+p</span><span style=color:#5fb3b3>')
</span></code></pre><ul><li>Borrar texto sin alterar el registro</ul><p>Cuando borramos algo en modo normal o visual usando <code>c</code>, <code>d</code> o <code>x</code> ese texto se va un registro. Esto afecta el texto que podemos pegar con la tecla <code>p</code>. Lo que quiero hacer es modificar <code>x</code> para poder borrar texto sin afectar el "historial" de copias.<pre class=language-lua data-lang=lua style=background:#2b2c2f;color:#cccece><code class=language-lua data-lang=lua><span>vim</span><span style=color:#5fb3b3>.</span><span>keymap</span><span style=color:#5fb3b3>.</span><span style=color:#6699cc>set</span><span style=color:#5fb3b3>({'</span><span style=color:#99c794>n</span><span style=color:#5fb3b3>', '</span><span style=color:#99c794>x</span><span style=color:#5fb3b3>'}, '</span><span style=color:#99c794>x</span><span style=color:#5fb3b3>', '</span><span style=color:#99c794>"_x</span><span style=color:#5fb3b3>')
</span></code></pre><ul><li>Seleccionar todo el texto</ul><pre class=language-lua data-lang=lua style=background:#2b2c2f;color:#cccece><code class=language-lua data-lang=lua><span>vim</span><span style=color:#5fb3b3>.</span><span>keymap</span><span style=color:#5fb3b3>.</span><span style=color:#6699cc>set</span><span style=color:#5fb3b3>('</span><span style=color:#99c794>n</span><span style=color:#5fb3b3>', '</span><span style=color:#99c794>&LTleader>a</span><span style=color:#5fb3b3>', '</span><span style=color:#99c794>:keepjumps normal! ggVG&LTCR></span><span style=color:#5fb3b3>')
</span></code></pre><h2 id=plugin-manager>Plugin manager</h2><p>Vamos a usar <a href=https://github.com/folke/lazy.nvim rel=noopener target=_blank>lazy.nvim</a>. Me agrada porque podemos crear una configuración simple donde solamente escribimos una lista de plugins, pero también podemos crear módulos para la configuración de plugins. Por el momento mostraré el uso más simple.<p>Nuestro primer paso será instalar lazy.nvim. En la documentación nos muestran cómo hacerlo usando lua. Vamos a agregar esto.<pre class=language-lua data-lang=lua style=background:#2b2c2f;color:#cccece><code class=language-lua data-lang=lua><span style=color:#c594c5>local </span><span>lazy </span><span style=color:#5fb3b3>= {}
</span><span>
</span><span style=color:#c594c5>function </span><span>lazy</span><span style=color:#5fb3b3>.</span><span style=color:#6699cc>install</span><span style=color:#5fb3b3>(</span><span style=color:#f99157>path</span><span style=color:#5fb3b3>)
</span><span>  </span><span style=color:#c594c5>if </span><span style=color:#5fb3b3>not </span><span>vim</span><span style=color:#5fb3b3>.</span><span>loop</span><span style=color:#5fb3b3>.</span><span style=color:#6699cc>fs_stat</span><span style=color:#5fb3b3>(</span><span>path</span><span style=color:#5fb3b3>) </span><span style=color:#c594c5>then
</span><span>    </span><span style=color:#6699cc>print</span><span style=color:#5fb3b3>('</span><span style=color:#99c794>Installing lazy.nvim....</span><span style=color:#5fb3b3>')
</span><span>    vim</span><span style=color:#5fb3b3>.</span><span>fn</span><span style=color:#5fb3b3>.</span><span style=color:#6699cc>system</span><span style=color:#5fb3b3>({
</span><span style=color:#6699cc>      </span><span style=color:#5fb3b3>'</span><span style=color:#99c794>git</span><span style=color:#5fb3b3>',
</span><span style=color:#6699cc>      </span><span style=color:#5fb3b3>'</span><span style=color:#99c794>clone</span><span style=color:#5fb3b3>',
</span><span style=color:#6699cc>      </span><span style=color:#5fb3b3>'</span><span style=color:#99c794>--filter=blob:none</span><span style=color:#5fb3b3>',
</span><span style=color:#6699cc>      </span><span style=color:#5fb3b3>'</span><span style=color:#99c794>https://github.com/folke/lazy.nvim.git</span><span style=color:#5fb3b3>',
</span><span style=color:#6699cc>      </span><span style=color:#5fb3b3>'</span><span style=color:#99c794>--branch=stable</span><span style=color:#5fb3b3>', </span><span style=color:#5f6364>-- latest stable release
</span><span style=color:#6699cc>      </span><span>path</span><span style=color:#5fb3b3>,
</span><span style=color:#6699cc>    </span><span style=color:#5fb3b3>})
</span><span>  </span><span style=color:#c594c5>end
</span><span style=color:#c594c5>end
</span><span>
</span><span style=color:#c594c5>function </span><span>lazy</span><span style=color:#5fb3b3>.</span><span style=color:#6699cc>setup</span><span style=color:#5fb3b3>(</span><span style=color:#f99157>plugins</span><span style=color:#5fb3b3>)
</span><span>  </span><span style=color:#c594c5>if </span><span>vim</span><span style=color:#5fb3b3>.</span><span>g</span><span style=color:#5fb3b3>.</span><span>plugins_ready </span><span style=color:#c594c5>then
</span><span>    </span><span style=color:#c594c5>return
</span><span>  </span><span style=color:#c594c5>end
</span><span>
</span><span>  </span><span style=color:#5f6364>-- Pueden comentar la siguiente línea una vez que lazy.nvim esté instalado
</span><span>  lazy</span><span style=color:#5fb3b3>.</span><span style=color:#6699cc>install</span><span style=color:#5fb3b3>(</span><span>lazy</span><span style=color:#5fb3b3>.</span><span style=color:#6699cc>path</span><span style=color:#5fb3b3>)
</span><span>
</span><span>  vim</span><span style=color:#5fb3b3>.</span><span>opt</span><span style=color:#5fb3b3>.</span><span>rtp</span><span style=color:#5fb3b3>:</span><span style=color:#6699cc>prepend</span><span style=color:#5fb3b3>(</span><span>lazy</span><span style=color:#5fb3b3>.</span><span style=color:#6699cc>path</span><span style=color:#5fb3b3>)
</span><span>
</span><span>  </span><span style=color:#6699cc>require</span><span style=color:#5fb3b3>('</span><span style=color:#99c794>lazy</span><span style=color:#5fb3b3>').</span><span style=color:#6699cc>setup</span><span style=color:#5fb3b3>(</span><span>plugins</span><span style=color:#5fb3b3>, </span><span>lazy</span><span style=color:#5fb3b3>.</span><span style=color:#6699cc>opts</span><span style=color:#5fb3b3>)
</span><span>  vim</span><span style=color:#5fb3b3>.</span><span>g</span><span style=color:#5fb3b3>.</span><span>plugins_ready </span><span style=color:#5fb3b3>= </span><span style=color:#f99157>true
</span><span style=color:#c594c5>end
</span></code></pre><p>Entonces, aquí tenemos dos funciones que están esperando para ser invocadas. Yo prefiero hacerlo de esta manera porque así puedo aislar el código que viene de la documentación.<p>Ahora tenemos que agregar nuestra configuración. Debemos especificar la ruta donde se instalarán los plugins, usamos la <code>lazy.path</code> para eso. Si quieren configurar lazy.nvim utilizan la variable <code>lazy.opts</code>, yo por el momento dejo la configuración vacía. Y para terminar vamos a colocar la lista de plugins en la función <code>lazy.setup</code>.<pre class=language-lua data-lang=lua style=background:#2b2c2f;color:#cccece><code class=language-lua data-lang=lua><span>lazy</span><span style=color:#5fb3b3>.</span><span>path </span><span style=color:#5fb3b3>= </span><span>vim</span><span style=color:#5fb3b3>.</span><span>fn</span><span style=color:#5fb3b3>.</span><span style=color:#6699cc>stdpath</span><span style=color:#5fb3b3>('</span><span style=color:#99c794>data</span><span style=color:#5fb3b3>') .. '</span><span style=color:#99c794>/lazy/lazy.nvim</span><span style=color:#5fb3b3>'
</span><span>lazy</span><span style=color:#5fb3b3>.</span><span>opts </span><span style=color:#5fb3b3>= {}
</span><span>
</span><span>lazy</span><span style=color:#5fb3b3>.</span><span style=color:#6699cc>setup</span><span style=color:#5fb3b3>({
</span><span style=color:#6699cc>  </span><span style=color:#5f6364>---
</span><span style=color:#6699cc>  </span><span style=color:#5f6364>-- Lista de plugins
</span><span style=color:#6699cc>  </span><span style=color:#5f6364>---
</span><span style=color:#5fb3b3>})
</span></code></pre><p>Aquí utilizamos <code>stdpath('data')</code> para que la ruta de los plugins quede en una carpeta manejada por Neovim. Ustedes pueden cambiar la ruta si quieren. Pero de esta manera no tenemos que preocuparnos por cambiar la ruta dependiendo del sistema operativo donde estamos.<p>Si quieren saber donde estarán los plugins usen este comando.<pre class=language-vim data-lang=vim style=background:#2b2c2f;color:#cccece><code class=language-vim data-lang=vim><span>:</span><span style=color:#6699cc>echo stdpath</span><span>(</span><span style=color:#99c794>'data'</span><span>) . </span><span style=color:#99c794>'/lazy/lazy.nvim'
</span></code></pre><p>Ahora vamos a descargar un plugin, un tema para que Neovim se vea mejor. Vamos a agregar esto en <code>lazy.setup</code>.<pre class=language-lua data-lang=lua style=background:#2b2c2f;color:#cccece><code class=language-lua data-lang=lua><span style=color:#5fb3b3>{'</span><span style=color:#99c794>folke/tokyonight.nvim</span><span style=color:#5fb3b3>'}</span><span>,
</span></code></pre><p>Esta es la cantidad mínima de información que lazy.nvim necesita para descargar un plugin de github. Solamente especificamos el usuario de github y el nombre del repositorio.<p>Su configuración va a quedar de esta manera.<pre class=language-lua data-lang=lua style=background:#2b2c2f;color:#cccece><code class=language-lua data-lang=lua><span>lazy</span><span style=color:#5fb3b3>.</span><span>path </span><span style=color:#5fb3b3>= </span><span>vim</span><span style=color:#5fb3b3>.</span><span>fn</span><span style=color:#5fb3b3>.</span><span style=color:#6699cc>stdpath</span><span style=color:#5fb3b3>('</span><span style=color:#99c794>data</span><span style=color:#5fb3b3>') .. '</span><span style=color:#99c794>/lazy/lazy.nvim</span><span style=color:#5fb3b3>'
</span><span>lazy</span><span style=color:#5fb3b3>.</span><span>opts </span><span style=color:#5fb3b3>= {}
</span><span>
</span><span>lazy</span><span style=color:#5fb3b3>.</span><span style=color:#6699cc>setup</span><span style=color:#5fb3b3>({
</span><span style=color:#6699cc>  </span><span style=color:#5fb3b3>{'</span><span style=color:#99c794>folke/tokyonight.nvim</span><span style=color:#5fb3b3>'},
</span><span style=color:#5fb3b3>})
</span></code></pre><p>Ahora vamos a agregar el código para aplicar el tema.<pre class=language-lua data-lang=lua style=background:#2b2c2f;color:#cccece><code class=language-lua data-lang=lua><span>vim</span><span style=color:#5fb3b3>.</span><span>opt</span><span style=color:#5fb3b3>.</span><span>termguicolors </span><span style=color:#5fb3b3>= </span><span style=color:#f99157>true
</span><span>vim</span><span style=color:#5fb3b3>.</span><span>cmd</span><span style=color:#5fb3b3>.</span><span style=color:#6699cc>colorscheme</span><span style=color:#5fb3b3>('</span><span style=color:#99c794>tokyonight</span><span style=color:#5fb3b3>')
</span></code></pre><p>Aquí habilitamos la opción <code>termguicolors</code> de Neovim para asegurarnos de tener la "mejor versión" del tema. Cada tema puede tener dos versiones, una para terminales que sólo soportan 256 colores y otra que utiliza códigos en hexadecimal (tiene más variedad de colores).<p>Para decirle a Neovim qué tema queremos usamos el comando <code>colorscheme</code>. Okey... técnicamente estamos usando una función de lua, pero esa función esta ejecutando un comando de vim.<pre class=language-lua data-lang=lua style=background:#2b2c2f;color:#cccece><code class=language-lua data-lang=lua><span>colorscheme tokyonight
</span></code></pre><p>Si guardamos los cambios y reiniciamos Neovim deberá aparecer un mensaje que nos muestra que se está clonando el repositorio de lazy.nvim. Una vez que lazy.nvim lea nuestra lista de plugins deberá aparecer una ventana extra, esta nos muestra la descarga de los plugins. Deberíamos ver los cambios de manera inmediata luego de que lazy.nvim termine la descarga del tema.<h2 id=configuracion-de-plugins>Configuración de plugins</h2><p>Cada autor puede crear el método de configuración que mejor le parezca. ¿Cómo sabemos qué debemos hacer? Leemos la documentación, no nos queda de otra.<p>Cada plugin como mínimo debe tener un archivo llamado <code>README.md</code>. Este es el archivo que github nos muestra en la página principal del repositorio. Ahí debemos buscar las instrucciones de configuración.<p>Si el archivo <code>README.md</code> no tiene la información que nos interesa busquen una carpeta llamada <code>doc</code>. Por lo general ahí se encuentra un archivo <code>txt</code>, esa es la página de ayuda. Podemos lear ese archivo desde github o desde Neovim si usamos el comando <code>:help nombre-archivo</code>.<h3 id=convenciones-de-plugins-escritos-en-lua>Convenciones de plugins escritos en lua</h3><p>Por suerte para nosotros muchos de los plugins escritos en lua siguen un patrón, usan una función llamada <code>setup</code> que acepta una tabla de lua como argumento. Si hay algo que deben aprender para configurar plugins en lua es cómo crear tablas.<p>Vamos a configurar un plugin. Para este ejemplo voy a usar <a href=https://github.com/nvim-lualine/lualine.nvim rel=noopener target=_blank>lualine</a>, un plugin que modifica la "línea de estado" que se encuentra en el fondo de la pantalla. Para descargarlo agregamos <code>nvim-lualine/lualine.nvim</code> a la lista de plugins.<pre class=language-lua data-lang=lua style=background:#2b2c2f;color:#cccece><code class=language-lua data-lang=lua><span>lazy</span><span style=color:#5fb3b3>.</span><span style=color:#6699cc>setup</span><span style=color:#5fb3b3>({
</span><span style=color:#6699cc>  </span><span style=color:#5fb3b3>{'</span><span style=color:#99c794>folke/tokyonight.nvim</span><span style=color:#5fb3b3>'},
</span><span style=color:#6699cc>  </span><span style=color:#5fb3b3>{'</span><span style=color:#99c794>nvim-lualine/lualine.nvim</span><span style=color:#5fb3b3>'},
</span><span style=color:#5fb3b3>})
</span></code></pre><p>Podemos empezar la configuración. Si revisan en github notarán que hay un archivo llamado <code>lualine.txt</code> en la carpeta <code>doc</code>. Podemos leerlo desde Neovim usando.<pre class=language-vim data-lang=vim style=background:#2b2c2f;color:#cccece><code class=language-vim data-lang=vim><span>:help lualine
</span></code></pre><p>La documentación nos dice que debemos llamar la función <code>setup</code> del módulo <code>lualine</code>. Así.<pre class=language-lua data-lang=lua style=background:#2b2c2f;color:#cccece><code class=language-lua data-lang=lua><span style=color:#6699cc>require</span><span style=color:#5fb3b3>('</span><span style=color:#99c794>lualine</span><span style=color:#5fb3b3>').</span><span style=color:#6699cc>setup</span><span style=color:#5fb3b3>()
</span></code></pre><p>Eso debería ser suficiente para que funcione. Podemos guardar los cambios y reiniciar Neovim.<p>Luce bien y todo pero yo quiero modificar algunas opciones. Por ejemplo, no quiero usar íconos, ¿cómo los deshabilito? En la sección <code>lualine-Default-configuration</code> puedo ver algo que dice <code>icons_enabled = true</code>. Lo que voy a hacer es copiar las propiedades que necesito para desactivarlo.<pre class=language-lua data-lang=lua style=background:#2b2c2f;color:#cccece><code class=language-lua data-lang=lua><span style=color:#6699cc>require</span><span style=color:#5fb3b3>('</span><span style=color:#99c794>lualine</span><span style=color:#5fb3b3>').</span><span style=color:#6699cc>setup</span><span style=color:#5fb3b3>({
</span><span style=color:#6699cc>  </span><span style=color:#99c794>options </span><span style=color:#5fb3b3>= {
</span><span style=color:#6699cc>    </span><span style=color:#99c794>icons_enabled </span><span style=color:#5fb3b3>= </span><span style=color:#f99157>false</span><span style=color:#5fb3b3>,
</span><span style=color:#6699cc>  </span><span style=color:#5fb3b3>}
</span><span style=color:#5fb3b3>})
</span></code></pre><p>Digamos que tenemos un problema con nuestra fuente, no podemos ver los "separadores de componentes". Tenemos que desactivarlos. Si nos vamos a la sección <code>lualine-Disabling-separators</code> nos muestra esto.<pre class=language-lua data-lang=lua style=background:#2b2c2f;color:#cccece><code class=language-lua data-lang=lua><span>options </span><span style=color:#5fb3b3>= { </span><span style=color:#99c794>section_separators </span><span style=color:#5fb3b3>= '', </span><span style=color:#99c794>component_separators </span><span style=color:#5fb3b3>= '' }
</span></code></pre><p>No vamos a copiar/pegar ese código como está. Tenemos que interpretarlo. Nos muestra la propiedad <code>options</code>, nosotros ya tenemos una de esas, entonces lo que hacemos es agregar las propiedades nuevas.<pre class=language-lua data-lang=lua style=background:#2b2c2f;color:#cccece><code class=language-lua data-lang=lua><span style=color:#6699cc>require</span><span style=color:#5fb3b3>('</span><span style=color:#99c794>lualine</span><span style=color:#5fb3b3>').</span><span style=color:#6699cc>setup</span><span style=color:#5fb3b3>({
</span><span style=color:#6699cc>  </span><span style=color:#99c794>options </span><span style=color:#5fb3b3>= {
</span><span style=color:#6699cc>    </span><span style=color:#99c794>icons_enabled </span><span style=color:#5fb3b3>= </span><span style=color:#f99157>false</span><span style=color:#5fb3b3>,
</span><span style=color:#6699cc>    </span><span style=color:#99c794>section_separators </span><span style=color:#5fb3b3>= '',
</span><span style=color:#6699cc>    </span><span style=color:#99c794>component_separators </span><span style=color:#5fb3b3>= ''
</span><span style=color:#6699cc>  </span><span style=color:#5fb3b3>}
</span><span style=color:#5fb3b3>})
</span></code></pre><p>Ahora que tenemos lualine instalado podemos guardar el archivo y ejecutar <code>:source $MYVIMRC</code> para ver los cambios.<p>En resumen, para configurar plugins debemos: saber cómo navegar en la documentación del plugin y también debemos conocer la sintaxis de lua para crear tablas.<h3 id=plugins-en-vimscript>Plugins en vimscript</h3><p>Aún hay muchos plugins útiles que están escritos en vimscript. En la mayoría de los casos los configuramos usando variables globales. En lua podremos modificar variables globales de vimscript usando <code>vim.g</code>.<p>¿Ya les conté que Neovim viene con un explorador de archivos? Podemos acceder a él con el comando <code>:Lexplore</code>. Este explorador es de hecho un plugin escrito en vimscript, entonces no tenemos una función <code>setup</code>. Para saber cómo configurarlo debemos buscar en su documentación.<pre class=language-vim data-lang=vim style=background:#2b2c2f;color:#cccece><code class=language-vim data-lang=vim><span>:help netrw
</span></code></pre><p>Si revisan la tabla de contenido de esa página de ayuda notarán una sección llamada <code>netrw-browser-settings</code>. Ahí nos muestran una lista de variables y sus descripciones. Vamos a fijarnos en las que comienzan con el prefijo <code>g:</code>.<p>Por ejemplo si queremos ocultar el texto de ayuda usamos <code>netrw_banner</code>.<pre class=language-lua data-lang=lua style=background:#2b2c2f;color:#cccece><code class=language-lua data-lang=lua><span>vim</span><span style=color:#5fb3b3>.</span><span>g</span><span style=color:#5fb3b3>.</span><span>netrw_banner </span><span style=color:#5fb3b3>= </span><span style=color:#f99157>0
</span></code></pre><p>Podríamos cambiar el tamaño de la ventana.<pre class=language-lua data-lang=lua style=background:#2b2c2f;color:#cccece><code class=language-lua data-lang=lua><span>vim</span><span style=color:#5fb3b3>.</span><span>g</span><span style=color:#5fb3b3>.</span><span>netrw_winsize </span><span style=color:#5fb3b3>= </span><span style=color:#f99157>30
</span></code></pre><p>Eso es todo... bueno, hay más variables que pueden modificar pero en general esto es lo más básico que deben saber. Revisan la documentación, identifican la variable que quieren modificar y la cambian con <code>vim.g</code>.<h2 id=informacion-extra>Información extra</h2><h3 id=atajos-recursivos-y-no-recursivos>Atajos recursivos y no recursivos</h3><p>Si ya conocen la palabra "recursividad" tal vez puedan intuir qué consecuencias tienen este tipo de atajos. Si no, dejénme demostrarles con un ejemplo.<p>Digamos que tenemos este atajo que abre el explorador de archivos.<pre class=language-lua data-lang=lua style=background:#2b2c2f;color:#cccece><code class=language-lua data-lang=lua><span>vim</span><span style=color:#5fb3b3>.</span><span>keymap</span><span style=color:#5fb3b3>.</span><span style=color:#6699cc>set</span><span style=color:#5fb3b3>('</span><span style=color:#99c794>n</span><span style=color:#5fb3b3>', '</span><span style=color:#99c794>&LTF2></span><span style=color:#5fb3b3>', '</span><span style=color:#99c794>&LTcmd>Lexplore&LTcr></span><span style=color:#5fb3b3>')
</span></code></pre><p>Bien, ahora vamos a crear un atajo recursivo que utilice <code>F2</code>.<pre class=language-lua data-lang=lua style=background:#2b2c2f;color:#cccece><code class=language-lua data-lang=lua><span>vim</span><span style=color:#5fb3b3>.</span><span>keymap</span><span style=color:#5fb3b3>.</span><span style=color:#6699cc>set</span><span style=color:#5fb3b3>('</span><span style=color:#99c794>n</span><span style=color:#5fb3b3>', '</span><span style=color:#99c794>&LTspace>&LTspace></span><span style=color:#5fb3b3>', '</span><span style=color:#99c794>&LTF2></span><span style=color:#5fb3b3>', {</span><span style=color:#99c794>remap </span><span style=color:#5fb3b3>= </span><span style=color:#f99157>true</span><span style=color:#5fb3b3>})
</span></code></pre><p>Si pulsan <code>Espacio</code> dos veces seguidas les aparecerá el explorador. Pero si cambian <code>remap</code> de <code>true</code> a <code>false</code>, no aparecerá nada.<p>Con los atajos recursivos, podremos usar otros atajos definidos por nosotros mismos o por plugins en el parámetro <code>{rhs}</code>. Con los atajos "no recursivos" sólo tendremos acceso a los atajos definidos directamente por Neovim.<p>Por lo general sólo queremos atajos recursivos cuando vamos a usar funcionalidades creadas por plugins.<p>¿Por qué los atajos recursivos pueden causar conflictos? Consideren esto.<pre class=language-lua data-lang=lua style=background:#2b2c2f;color:#cccece><code class=language-lua data-lang=lua><span>vim</span><span style=color:#5fb3b3>.</span><span>keymap</span><span style=color:#5fb3b3>.</span><span style=color:#6699cc>set</span><span style=color:#5fb3b3>('</span><span style=color:#99c794>n</span><span style=color:#5fb3b3>', '</span><span style=color:#99c794>*</span><span style=color:#5fb3b3>', '</span><span style=color:#99c794>*zz</span><span style=color:#5fb3b3>')
</span></code></pre><p>Noten que estamos usando <code>*</code> en <code>{lhs}</code> y también en <code>{rhs}</code>. Si este atajo fuera recursivo estaríamos creando un ciclo infinito. Neovim intentará llamar a la funcionalidad atada a <code>*</code> y nunca ejecuta <code>zz</code>.<h3 id=comandos-de-usuario>Comandos de usuario</h3><p>Sí, Neovim nos permite crear nuestros propios comandos. En lua usamos esta función.<pre class=language-lua data-lang=lua style=background:#2b2c2f;color:#cccece><code class=language-lua data-lang=lua><span>vim</span><span style=color:#5fb3b3>.</span><span>api</span><span style=color:#5fb3b3>.</span><span style=color:#6699cc>nvim_create_user_command</span><span style=color:#5fb3b3>({</span><span>name</span><span style=color:#5fb3b3>}, {</span><span>command</span><span style=color:#5fb3b3>}, {</span><span>opts</span><span style=color:#5fb3b3>})
</span></code></pre><ul><li><p><code>{name}</code> es el nombre del comando, debe una cadena de texto y tiene que empezar con una letra mayúscula.</p><li><p><code>{command}</code> es la acción que queremos ejecutar. Puede una cadena de texto que contiene un fragmento de vimscript o puede ser una función de lua.</p><li><p><code>{opts}</code> debe ser una tabla de lua. No es opcional. Si no especifican ninguna opción deben colocar una tabla vacía.</p></ul><p>Ejemplo, podemos crear un comando dedicado para recargar nuestra configuración.<pre class=language-lua data-lang=lua style=background:#2b2c2f;color:#cccece><code class=language-lua data-lang=lua><span>vim</span><span style=color:#5fb3b3>.</span><span>api</span><span style=color:#5fb3b3>.</span><span style=color:#6699cc>nvim_create_user_command</span><span style=color:#5fb3b3>('</span><span style=color:#99c794>ReloadConfig</span><span style=color:#5fb3b3>', '</span><span style=color:#99c794>source $MYVIMRC</span><span style=color:#5fb3b3>', {})
</span></code></pre><p>Si quieren saber más detalles de los comandos de usuario revisen la documentación con los comandos.<pre class=language-vim data-lang=vim style=background:#2b2c2f;color:#cccece><code class=language-vim data-lang=vim><span>:help </span><span style=color:#6699cc>nvim_create_user_command</span><span>()
</span><span>:help user-commands
</span></code></pre><h3 id=autocomandos>Autocomandos</h3><p>Los autocomandos son acciones que Neovim puede ejecutar cuando ocurre un evento. Pueden revisar la lista de eventos con el comando <code>:help events</code>.<p>Podemos crear un autocomando con esta función.<pre class=language-lua data-lang=lua style=background:#2b2c2f;color:#cccece><code class=language-lua data-lang=lua><span>vim</span><span style=color:#5fb3b3>.</span><span>api</span><span style=color:#5fb3b3>.</span><span style=color:#6699cc>nvim_create_autocmd</span><span style=color:#5fb3b3>({</span><span>event</span><span style=color:#5fb3b3>}, {</span><span>opts</span><span style=color:#5fb3b3>})
</span></code></pre><ul><li><p><code>{event}</code> debe ser el nombre de un evento.</p><li><p><code>{opts}</code> es una tabla de lua. Son las opciones que determinan el comportamiento del autocomando. Estas son algunas propiedades de uso común.</p> <ul><li><p><code>desc</code> es una cadena de texto que describe lo que hace el autocomando.</p><li><p><code>group</code> debe ser un número que representa el <code>id</code> de un grupo o una cadena de texto con el nombre de un grupo.</p><li><p><code>pattern</code> puede ser una tabla de lua o una cadena de texto. Nos permite filtrar los eventos en los que queremos ejecutar la acción. Su valor depende del evento. Deben revisar la documentación del evento para saber los posibles valores. Esta propiedad es opcional.</p><li><p><code>once</code> debe ser un booleano. Si lo habilitamos el autocomando sólo se ejecutará una vez. Su valor por defecto es <code>false</code>.</p><li><p><code>command</code> es una cadena de texto con un fragmento de vimscript. Es la acción que ejecutará el autocomando.</p><li><p><code>callback</code> puede ser una cadena de texto con el nombre de una función de vimscript o una función de lua. Es la acción que ejecutará el autocomando. No puede usarse en combinación con <code>command</code>.</p></ul></ul><p>Aquí les va un ejemplo. Voy a crear un grupo llamado <code>user_cmds</code> y le agregaré dos autocomandos.<pre class=language-lua data-lang=lua style=background:#2b2c2f;color:#cccece><code class=language-lua data-lang=lua><span style=color:#c594c5>local </span><span>augroup </span><span style=color:#5fb3b3>= </span><span>vim</span><span style=color:#5fb3b3>.</span><span>api</span><span style=color:#5fb3b3>.</span><span style=color:#6699cc>nvim_create_augroup</span><span style=color:#5fb3b3>('</span><span style=color:#99c794>user_cmds</span><span style=color:#5fb3b3>', {</span><span style=color:#99c794>clear </span><span style=color:#5fb3b3>= </span><span style=color:#f99157>true</span><span style=color:#5fb3b3>})
</span><span>
</span><span>vim</span><span style=color:#5fb3b3>.</span><span>api</span><span style=color:#5fb3b3>.</span><span style=color:#6699cc>nvim_create_autocmd</span><span style=color:#5fb3b3>('</span><span style=color:#99c794>FileType</span><span style=color:#5fb3b3>', {
</span><span style=color:#6699cc>  </span><span style=color:#99c794>pattern </span><span style=color:#5fb3b3>= {'</span><span style=color:#99c794>help</span><span style=color:#5fb3b3>', '</span><span style=color:#99c794>man</span><span style=color:#5fb3b3>'},
</span><span style=color:#6699cc>  </span><span style=color:#99c794>group </span><span style=color:#5fb3b3>= </span><span>augroup</span><span style=color:#5fb3b3>,
</span><span style=color:#6699cc>  </span><span style=color:#99c794>desc </span><span style=color:#5fb3b3>= '</span><span style=color:#99c794>Usar q para cerrar ventana</span><span style=color:#5fb3b3>',
</span><span style=color:#6699cc>  </span><span style=color:#99c794>command </span><span style=color:#5fb3b3>= '</span><span style=color:#99c794>nnoremap &LTbuffer> q &LTcmd>quit&LTcr></span><span style=color:#5fb3b3>'
</span><span style=color:#5fb3b3>})
</span><span>
</span><span>vim</span><span style=color:#5fb3b3>.</span><span>api</span><span style=color:#5fb3b3>.</span><span style=color:#6699cc>nvim_create_autocmd</span><span style=color:#5fb3b3>('</span><span style=color:#99c794>TextYankPost</span><span style=color:#5fb3b3>', {
</span><span style=color:#6699cc>  </span><span style=color:#99c794>group </span><span style=color:#5fb3b3>= </span><span>augroup</span><span style=color:#5fb3b3>,
</span><span style=color:#6699cc>  </span><span style=color:#99c794>desc </span><span style=color:#5fb3b3>= '</span><span style=color:#99c794>Resaltar texto copiado</span><span style=color:#5fb3b3>',
</span><span style=color:#6699cc>  callback </span><span style=color:#5fb3b3>= </span><span style=color:#c594c5>function</span><span style=color:#5fb3b3>(</span><span style=color:#f99157>event</span><span style=color:#5fb3b3>)
</span><span style=color:#6699cc>    </span><span>vim</span><span style=color:#5fb3b3>.</span><span style=color:#6699cc>highlight</span><span style=color:#5fb3b3>.</span><span style=color:#6699cc>on_yank</span><span style=color:#5fb3b3>({</span><span style=color:#99c794>higroup </span><span style=color:#5fb3b3>= '</span><span style=color:#99c794>Visual</span><span style=color:#5fb3b3>', </span><span style=color:#99c794>timeout </span><span style=color:#5fb3b3>= </span><span style=color:#f99157>200</span><span style=color:#5fb3b3>})
</span><span style=color:#6699cc>  </span><span style=color:#c594c5>end
</span><span style=color:#5fb3b3>})
</span></code></pre><p>Crear el grupo es opcional.<p>El primer autocomando creará el atajo <code>q</code> para cerrar la ventana actual, pero sólo si el archivo actual es de tipo <code>help</code> o <code>man</code>. En este ejemplo estoy usando vimscript en la propiedad <code>command</code>, pero también pude haberlo hecho usando lua con la propiedad <code>callback</code>.<p>El segundo autocomando usa una función de lua en la propiedad <code>callback</code>. Esta función lo que hace es resaltar el texto que copiamos. Pueden probar su efecto si copian una línea usando el atajo <code>yy</code>.<p>Para conocer más detalles de los autocomandos revisen la documentación.<pre class=language-vim data-lang=vim style=background:#2b2c2f;color:#cccece><code class=language-vim data-lang=vim><span>:help </span><span style=color:#6699cc>autocmd</span><span>-intro
</span></code></pre><h3 id=modulos-de-usuario>Módulos de usuario</h3><p>No hay ninguna regla que nos obligue a tener toda nuestra configuración en un solo archivo. Podemos crear módulos para separar la configuración en piezas más pequeñas.<p>La convención es colocar todos nuestros módulos en un "espacio único" para evitar conflictos con plugins. Muchas personas crean un módulo llamado <code>user</code> (ustedes pueden darle otro nombre si quieren). Para esto debemos ir la carpeta donde está <code>init.lua</code>, crear el directorio <code>lua</code>, y dentro creamos <code>user</code>. Podemos hacer todo eso con un comando.<pre class=language-vim data-lang=vim style=background:#2b2c2f;color:#cccece><code class=language-vim data-lang=vim><span>:call </span><span style=color:#6699cc>mkdir</span><span>(</span><span style=color:#6699cc>stdpath</span><span>(</span><span style=color:#99c794>"config"</span><span>) . </span><span style=color:#99c794>"/lua/user"</span><span>, </span><span style=color:#99c794>"p"</span><span>)
</span></code></pre><p>Ya dentro de <code>/lua/user</code> podemos crear nuestros scripts de lua. Vamos a suponer que tenemos uno llamado <code>settings.lua</code>. Ahora, Neovim no sabe que ese script existe, no lo va a ejecutar, nosotros debemos llamarlo desde <code>init.lua</code> así.<pre class=language-lua data-lang=lua style=background:#2b2c2f;color:#cccece><code class=language-lua data-lang=lua><span style=color:#6699cc>require</span><span style=color:#5fb3b3>('</span><span style=color:#99c794>user.settings</span><span style=color:#5fb3b3>')
</span></code></pre><p>Si quieren saber con detalle cómo funciona require... revisen la documentación.<pre class=language-vim data-lang=vim style=background:#2b2c2f;color:#cccece><code class=language-vim data-lang=vim><span>:help </span><span style=color:#6699cc>lua</span><span>-require
</span></code></pre><h3 id=la-funcion-require>La función require</h3><p>Algo que deben saber de <code>require</code> es que sólo ejecuta el módulo una vez. ¿Qué quiere decir esto?<p>Consideren este código.<pre class=language-lua data-lang=lua style=background:#2b2c2f;color:#cccece><code class=language-lua data-lang=lua><span style=color:#6699cc>require</span><span style=color:#5fb3b3>('</span><span style=color:#99c794>user.settings</span><span style=color:#5fb3b3>')
</span><span style=color:#6699cc>require</span><span style=color:#5fb3b3>('</span><span style=color:#99c794>user.settings</span><span style=color:#5fb3b3>')
</span></code></pre><p>Aquí el script <code>settings.lua</code> sólo se ejecutará una vez. Si desean crear plugins o alguna funcionalidad que depende de un plugin, esto es bueno. Lo malo es que si quieren usar el comando <code>:source $MYVIMRC</code> para "recargar" su configuración no obtendrán el resultado que quieren.<p>Hay un truco que pueden hacer. Pueden invalidar el caché de la función <code>require</code> antes de invocarla con un módulo. Ejemplo.<pre class=language-lua data-lang=lua style=background:#2b2c2f;color:#cccece><code class=language-lua data-lang=lua><span style=color:#c594c5>local </span><span style=color:#6699cc>load </span><span style=color:#5fb3b3>= </span><span style=color:#c594c5>function</span><span style=color:#5fb3b3>(</span><span style=color:#f99157>mod</span><span style=color:#5fb3b3>)
</span><span>  </span><span style=color:#f99157>package</span><span style=color:#5fb3b3>.</span><span style=color:#f99157>loaded</span><span style=color:#5fb3b3>[</span><span>mod</span><span style=color:#5fb3b3>] = </span><span style=color:#f99157>nil
</span><span>  </span><span style=color:#6699cc>require</span><span style=color:#5fb3b3>(</span><span>mod</span><span style=color:#5fb3b3>)
</span><span style=color:#c594c5>end
</span><span>
</span><span style=color:#6699cc>load</span><span style=color:#5fb3b3>('</span><span style=color:#99c794>user.settings</span><span style=color:#5fb3b3>')
</span><span style=color:#6699cc>load</span><span style=color:#5fb3b3>('</span><span style=color:#99c794>user.keymaps</span><span style=color:#5fb3b3>')
</span></code></pre><p>Sí hacemos esto en <code>init.lua</code> el comando <code>source</code> podrá ejecutar los módulos <code>settings</code> y <code>keymaps</code> de manera efectiva.<p><strong>ADVERTENCIA</strong>. Deben tener en cuenta que algunos plugins pueden actuar de manera extraña si los configuran más de una vez. Es decir, si ustedes usan <code>:source $MYVIMRC</code> y provocan que la función <code>setup</code> de un plugin se ejecute por segunda vez puede causar efectos inesperados.<h2 id=init-lua>init.lua</h2><p>Entonces, si aplican (casi) todo lo que les enseñé hoy este sería el resultado.<ul><li><a href=https://github.com/VonHeikemen/nvim-starter/blob/01-base/init.lua rel=noopener target=_blank>init.lua</a></ul><h2 id=que-sigue>¿Qué sigue?</h2><p>Tal vez instalar otros plugins, tengo otro artículo que habla sobre plugins populares y cómo configurarlos.<ul><li><a href=https://vonheikemen.github.io/devlog/es/tools/neovim-plugins-to-get-started/>Plugins para empezar</a></ul><p>Si ya se sienten preparados para temas más avanzados, el siguiente artículo les enseñará cómo configurar el autocompletado y agregar soporte para servidores LSP:<ul><li><a href=https://vonheikemen.github.io/devlog/es/tools/setup-nvim-lspconfig-plus-nvim-cmp/>Configurando nvim-lspconfig + nvim-cmp</a></ul><p>Si quieren recomendaciones de plugins y configuraciones pueden revisar estas plantillas.<ul><li><a href=https://github.com/nvim-lua/kickstart.nvim rel=noopener target=_blank>kickstart.nvim</a><li><a href=https://github.com/VonHeikemen/nvim-starter/tree/xx-light rel=noopener target=_blank>nvim-starter - light</a><li><a href=https://github.com/NvChad/tinyvim rel=noopener target=_blank>tinyvim</a><li><a href=https://github.com/glepnir/dope rel=noopener target=_blank>dope</a><li><a href=https://github.com/LunarVim/nvim-basic-ide rel=noopener target=_blank>nvim-basic-ide</a></ul><p>Si quieren revisar mi configuración personal:<ul><li><a href=https://github.com/VonHeikemen/dotfiles/tree/master/my-configs/neovim rel=noopener target=_blank>neovim config</a>.</ul><h2 id=conclusion>Conclusión</h2><p>Ahora sabemos cómo modificar las opciones básicas de Neovim. Aprendimos cómo crear nuestros propios atajos. Podemos hacer que Neovim descargue plugins desde github. Configuramos un par de plugins, uno escrito en lua, otro escrito en vimscript. Dimos un vistazo a temas como atajos recursivos, comandos de usuario, autocomandos, módulos y algunos trucos.<p>En este punto ya tenemos todas la herramientas para explorar plugins, ver las configuraciones de otras personas y aprender de ellas.<hr><p>¿Tienen alguna pregunta? Pueden dejar un comentario en cualquiera de estas plataformas:<ul><li><a href=https://dev.to/vonheikemen/como-crear-tu-primera-configuracion-de-neovim-usando-lua-dah rel=noopener target=_blank>dev.to</a><li><a href=https://vonheikemen.hashnode.dev/build-your-first-neovim-configuration-in-lua-es rel=noopener target=_blank>Hashnode</a></ul><p>Pueden contactarme por las redes sociales:<ul><li>Twitter <a rel="noopener me" href=https://twitter.com/VonHeikemen_ target=_blank> @VonHeikemen_ </a><li>Mastodon <a rel="noopener me" href=https://hachyderm.io/@vonheikemen target=_blank> @vonheikemen@hachyderm.io </a></ul><p>Gracias por su tiempo. Si este artículo les pareció útil y quieren apoyar mis esfuerzos para crear más contenido, pueden dejar una propina en buy me a coffee ☕.</p><a href=https://www.buymeacoffee.com/vonheikemen style=display:flex;justify-content:center target=_blank> <img alt="Buy Me A Coffee" src=https://cdn.buymeacoffee.com/buttons/v2/default-blue.png style=height:60px!important;width:217px!important> </a></div></div>